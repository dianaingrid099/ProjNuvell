<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Início | Nuvell</title>
    <link rel="stylesheet" href="assets/css/page/Principal/style.css">
    <link href='https://fonts.googleapis.com/css?family=League Spartan' rel='stylesheet'>
    <script src="https://kit.fontawesome.com/81389dc184.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
        crossorigin="anonymous"></script>
</head>

<body>

    <header>

        <nav>

            <a href="index.html" class="icon-logo">
                <i class="fa-solid fa-paw"></i>
                <h2> Nuvell</h2>
            </a>

            <section class="navbar-texto">
                <a href="#Destaques">Destaques</a>
                <a href="#pelucias">Pelúcias</a>
                <a href="colecao.html">Coleções</a>
            </section>

            <div class="icons">
                <a id="abrir-carrinho" href="#"><i class="fa-solid fa-cart-shopping btn-compra"></i></a>
                <a href="login.html"><button class="btn-entrar">Entrar</button></a>
                <a href="perfil.html" id="user-icon" class="hidden"><i class="fa-solid fa-user"></i></a>
            </div>

        </nav>

    </header>

    <section id="carrinho" class="position-fixed top-0  bg-light text-dark p-4"
        style="width: 360px; height: 100vh; right: -360px; transition: right 0.2s; z-index: 1050; display: flex; flex-direction: column; justify-content: space-between;">
        <div class="d-flex justify-content-between mb-4">
            <p class="h4">Meu carrinho</p>
            <button id="fechar-carrinho" class="btn btn-sm btn-outline-dark">✖</button>
        </div>

        <section id="produtos-carrinho" class="overflow-auto flex-grow-1 mb-3" style="max-height: 60vh;"></section>

        <p class="h5" id="preco-total">Total: R$0</p>
        <a href="./compra.html" id="finalizar-compra"><button class="btn btn-dark text-light mt-2" >Finalizar Compra</button> </a> 
    </section>

    <section class="capa">

        <div></div>

        <div class="conteudo-capa">

            <h1>Conheça a Nuvell</h1>
            <p>Encante-se com nossos produtos fofinhos e exclusivos! <br> cuidadosamente selecionados para trazer
                alegria, charme <br> e um toque especial ao seu dia a dia!</p>
            <a href="colecao.html">
                <button class="btn-ver-agora">Ver agora!</button>
            </a>

        </div>

    </section>

    <section class="destaques" id="Destaques">

        <div class="destaques-titulo">
            <i class="fa-regular fa-star"></i>
            <h2>Destaques</h2>
        </div>

        <div class="carrousel">
            <div id="carouselExampleIndicators" class="carousel slide w-100" data-bs-ride="carousel"
                data-bs-interval="2500">

                <div class="carousel-indicators">
                    <button type="button " data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0"
                        class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                        aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                        aria-label="Slide 3"></button>
                </div>

                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <a href="colecao.html">
                            <img src="assets/css/page/Principal/image/TelaCard1.png" class="d-block w-100" alt="...">
                        </a>
                    </div>
                    <div class="carousel-item">
                        <a href="colecao.html">
                            <img src="assets/css/page/Principal/image/TelaCard2.png" class="d-block w-100" alt="...">
                        </a>
                    </div>
                    <div class="carousel-item">
                        <a href="colecao.html">
                            <img src="assets/css/page/Principal/image/TelaCard3.png" class="d-block w-100" alt="...">
                        </a>
                    </div>
                </div>

                <button class="carousel-control-prev " type="button" data-bs-target="#carouselExampleIndicators"
                    data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>

                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
                    data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden ">Next</span>
                </button>

            </div>
        </div>
    </section>


    <div class="fundo-pelucias">

        <section class="pelucias" id="pelucias">
            <div class="titulo-pelucias">
                <i class="fa-solid fa-bag-shopping"></i>
                <h2 id="Pelúcia">Pelúcias</h2>
            </div>

            <div class="carousel-wrapper">
                <div class="carousel-track" id="carousel-track">
                    <!-- Cards injetados pelo JS -->
                </div>
            </div>

            <div class="carousel-buttons" style="gap: 20px;">
                <button id="btn-prev" class="btn btn-primary">&#8249; Anterior</button>
                <button id="btn-next" class="btn btn-primary">Próximo &#8250;</button>
            </div>
        </section>

    </div>


    <section class="sobre">

        <div class="conteudo-sobre">

            <h1>Sobre a Nuvell</h1>

            <div class="sobre-coluna">

                <div class="coluna1 coluna">

                    <div>
                        <i class="fa-solid fa-globe"></i>
                        <h2 class="sobre-titulo">Sobre</h2>
                    </div>

                    <p>Na Nuvell, cada bichinho é muito mais do que um simples brinquedo — é um verdadeiro
                        companheiro,
                        cheio de personalidade e fofura. Criados com carinho em cada detalhe, eles são feitos para
                        despertar sorrisos, aquecer corações e transformar momentos comuns em lembranças especiais.
                        Seja
                        para presentear alguém querido ou para ter sempre por perto, nossos bichinhos carregam
                        consigo
                        um toque de magia, prontos para fazer parte das suas histórias e viver grandes aventuras ao
                        seu
                        lado.
                    </p>

                </div>

                <div class="coluna2 coluna">

                    <div>
                        <i class="fa-solid fa-circle-user"></i>
                        <h2 class="sobre-titulo">Conheça mais</h2>
                    </div>

                    <p>Visite nosso espaço físico ou acesse nosso site e mergulhe de cabeça no encantador universo
                        dos
                        bichos de pelúcia! Aqui, cada cantinho foi pensado para despertar a imaginação e aquecer o
                        coração. Descubra coleções exclusivas, criadas com todo o carinho para trazer alegria em
                        cada
                        detalhe. Aproveite promoções especiais, pensadas para tornar seu momento de compra ainda
                        mais
                        mágico, e fique por dentro das novidades que chegam a cada temporada, sempre trazendo novos
                        personagens, cores e histórias.
                    </p>

                </div>

            </div>

        </div>

    </section>

    <footer>

        <div class="conteudo-footer">
            <div class="midias">

                <div class="logo-footer">
                    <i class="fa-solid fa-paw"></i>
                    <h2> Nuvell</h2>
                </div>

                <div class="midias-footer">
                    <a href="#"><i class="fa-brands fa-facebook"></i></a>
                    <a href="#"><i class="fa-brands fa-linkedin"></i></a>
                    <a href="#"><i class="fa-brands fa-youtube"></i></a>
                    <a href="#"><i class="fa-brands fa-square-instagram"></i></a>
                </div>

            </div>

            <div class="notas">

                <div class="notas-coluna1 notas-coluna">

                    <h4>Produtos</h4>

                    <a class="texto-coluna" href="#">
                        <p>Novidades</p>
                    </a>
                    <a class="texto-coluna" href="#">
                        <p>Mais Vendidos</p>
                    </a>
                    <a class="texto-coluna" href="#">
                        <p>Personalizados</p>
                    </a>

                </div>

                <div class="notas-coluna2 notas-coluna">

                    <h4>Ajuda</h4>

                    <a class="texto-coluna" href="#">
                        <p>Troca e Devoluções</p>
                    </a>
                    <a class="texto-coluna" href="#">
                        <p>Suporte Cliente</p>
                    </a>
                    <a class="texto-coluna" href="#">
                        <p>Rastreamento</p>
                    </a>

                </div>

                <div class="notas-coluna3 notas-coluna">

                    <h4>Sobre</h4>

                    <a class="texto-coluna" href="#">
                        <p>Quem Somos</p>
                    </a>
                    <a class="texto-coluna" href="#">
                        <p>Nossa Missão</p>
                    </a>
                    <a class="texto-coluna" href="#">
                        <p>Sustentabilidade</p>
                    </a>

                </div>

            </div>
        </div>

    </footer>
    <script src="assets/css/global/script.js"></script>
    <script>


        window.addEventListener("DOMContentLoaded", () => {
            console.log("carregou o dom")
            const baseUrl = "http://localhost:5050"
            getProdutos();

            function getProdutos() {
                console.log("caiu na getprodutos")

                try {
                    const response = fetch(`${baseUrl}/getProdutos`)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Erro na resposta: ' + response.status);
                            }
                            carregarCarrossel();
                            return response.json(); // transforma a resposta em JSON
                        })
                        .then(produtos => carregarCarrossel(produtos));
                } catch (e) {
                    console.log(e);
                }
            }

            function carregarCarrossel(produtos) {
                console.log("caiu na carregar carrossel")

                const track = document.getElementById('carousel-track');
                const cardMargin = 10;
                const cardRem = 21;
                const remInPixels = parseFloat(getComputedStyle(document.documentElement).fontSize);
                const cardWidth = cardRem * remInPixels + cardMargin;



                // Geração dos cards reais
                for (const index in produtos) {
                    const produto = produtos[index];

                    const card = document.createElement('div');
                    card.className = 'card';
                    card.style.borderRadius = '30px';
                    card.style.border = 'none';
                    card.style.minWidth = `${cardRem}rem`;
                    card.style.marginRight = `${cardMargin}px`;
                    const nomeProduto = produto.nome.replace("-", " ");
                    console.log(produto.id);

                    card.innerHTML = `
                        <img src="assets/css/global/Pelucias/${produto.nome}.png" alt="Pelúcia ${nomeProduto}" style="width:100%">
                        <div class="card-body">
                            <h5 class="card-title">${nomeProduto}</h5>
                            <a href="venda.html?id=${produto.id}" class="btn btn-primary"
                            style="padding: 10px 20px; border: #4A3333 solid 2px; background-color: #4A3333; font-weight: 500;">Comprar</a>
                        </div>
                        `;

                    track.appendChild(card);
                }

                const realCards = Array.from(track.querySelectorAll('.card'));
                const realCount = realCards.length;

                // Clones apenas no fim
                realCards.forEach(card => {
                    const clone = card.cloneNode(true);
                    clone.classList.add('clone');
                    track.appendChild(clone);
                });

                let currentIndex = 0;
                let transitioning = false;

                function updatePosition(smooth = true) {
                    track.style.transition = smooth ? 'transform 0.5s ease' : 'none';
                    track.style.transform = `translateX(-${cardWidth * currentIndex}px)`;
                }

                function moveTo(index) {
                    if (transitioning) return;
                    transitioning = true;

                    currentIndex = index;
                    updatePosition(true);

                    setTimeout(() => {
                        if (currentIndex >= realCount) {
                            // Ao ultrapassar os reais, salta de volta pro 1º real sem animação
                            currentIndex = 0;
                            updatePosition(false);
                        }
                        transitioning = false;
                    }, 500);
                }

                function nextSlide() { moveTo(currentIndex + 1); }
                function prevSlide() {
                    currentIndex = currentIndex - 1 < 0 ? realCount - 1 : currentIndex - 1;
                    updatePosition();
                }

                let autoSlideTimeout;

                function startAutoSlide() {
                    autoSlideTimeout = setTimeout(function slide() {
                        nextSlide();
                        autoSlideTimeout = setTimeout(slide, 4000);
                    }, 4000);
                }

                function stopAutoSlide() {
                    clearTimeout(autoSlideTimeout);
                }

                document.getElementById('btn-next')?.addEventListener('click', () => {
                    stopAutoSlide();
                    nextSlide();
                    setTimeout(startAutoSlide, 4000);
                });

                document.getElementById('btn-prev')?.addEventListener('click', () => {
                    stopAutoSlide();
                    prevSlide();
                    setTimeout(startAutoSlide, 4000);
                });

                document.querySelector('.carousel-wrapper')?.addEventListener('mouseenter', stopAutoSlide);
                document.querySelector('.carousel-wrapper')?.addEventListener('mouseleave', () => {
                    setTimeout(startAutoSlide, 4000);
                });

                updatePosition(false);
                startAutoSlide();
            }

        });
    </script>

    <!-- Bootstrap JS + seu script de carrinho -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="./JavaScript/carrinho.js"></script>

</body>